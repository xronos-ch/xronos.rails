<h1>Database</h1>

<hr>

<p>
The general logic of the xronos.rails database is best understood from the perspective of the
<b>arch_object</b> entity. <b>Archaeological objects</b> are dated artefacts or samples with
archaeological context information.
</p>

<!-- #### Links to models #### -->
<svg height="190px" width="100%" xmlns:xlink=â€œhttp://www.w3.org/1999/xlink">
	<!-- 1 -->
	<a xlink:href="arch_objects"><text transform="rotate(-90, 100, 100)" x="80" y="10" fill="#fff">arch_object</text></a>
	<!-- 2 -->
	<a xlink:href="samples"><text x="30" y="15" fill="#fff">sample</text></a>
	<a xlink:href="site_phases"><text x="30" y="60" fill="#fff">site_phase</text></a>
	<a xlink:href="on_site_object_positions"><text x="30" y="150" fill="#fff">on_site</text></a>
	<a xlink:href="materials"><text x="30" y="165" fill="#fff">material</text></a>
	<a xlink:href="species"><text x="30" y="180" fill="#fff">species</text></a>
	<!-- 3 -->
	<a xlink:href="measurements"><text x="120" y="15" fill="#fff">meas</text></a>
	<a xlink:href="sites"><text x="120" y="60" fill="#fff">site</text></a>
	<a xlink:href="site_types"><text x="120" y="90" fill="#fff">site_t</text></a>
	<a xlink:href="periods"><text x="120" y="105" fill="#fff">period</text></a>
	<a xlink:href="typochronological_units"><text x="120" y="120" fill="#fff">typo</text></a>
	<a xlink:href="ecochronological_units"><text x="120" y="135" fill="#fff">eco</text></a>
	<a xlink:href="feature_types"><text x="120" y="150" fill="#fff">feature_t</text></a>
	<!-- 4 -->
	<a xlink:href="c14_measurements"><text x="210" y="15" fill="#fff">c14_meas</text></a>
	<a xlink:href="references"><text x="210" y="30" fill="#fff">reference</text></a>
	<a xlink:href="labs"><text x="210" y="45" fill="#fff">lab</text></a>
	<a xlink:href="countries"><text x="210" y="60" fill="#fff">country</text></a>
	<a xlink:href="fell_phases"><text x="210" y="75" fill="#fff">fell_phase</text></a>
	<!-- vlines: left to right-->
	<line y1="0"   x1="20"  y2="175" x2="20"  stroke-width="0.5" stroke="#fff"/>
	<line y1="0"   x1="110" y2="139" x2="110" stroke-width="0.5" stroke="#fff"/>
	<line y1="0"   x1="200" y2="79"  x2="200" stroke-width="0.5" stroke="#fff"/>
	<!-- hlines: top to bottom -->
	<line y1="19"  x1="200" y2="19"  x2="290" stroke-width="0.5" stroke="#fff"/>
	<line y1="34"  x1="200" y2="34"  x2="290" stroke-width="0.5" stroke="#fff"/>
	<line y1="49"  x1="20"  y2="49"  x2="290" stroke-width="0.5" stroke="#fff"/>
	<line y1="64"  x1="200" y2="64"  x2="290" stroke-width="0.5" stroke="#fff"/>
	<line y1="79"  x1="110" y2="79"  x2="290" stroke-width="0.5" stroke="#fff"/>
  <line y1="94"  x1="110" y2="94"  x2="200" stroke-width="0.5" stroke="#fff"/>
  <line y1="109" x1="110" y2="109" x2="200" stroke-width="0.5" stroke="#fff"/>
  <line y1="124" x1="110" y2="124" x2="200" stroke-width="0.5" stroke="#fff"/>
	<line y1="139" x1="20"  y2="139" x2="200" stroke-width="0.5" stroke="#fff"/>
	<line y1="154" x1="20"  y2="154" x2="200" stroke-width="0.5" stroke="#fff"/>
	<line y1="169" x1="20"  y2="169" x2="110" stroke-width="0.5" stroke="#fff"/>
</svg>

<p>
The database was modelled with an Entity Relationship (ER) diagram:
</p>

<%= image_tag "xronos_erd.png", width: '100%' %>

Some help on how to read this chart:

<ul>
  <li>Boxes: Entity. An entity is a class of objects in the real world (e.g. *archaeological sites*)
    that can be described with a set of attributes (e.g. *name, number of documented houses, spatial
    position*). All entities will become tables in database.</li>
  <li>Diamonds: Relationship. Relationships describe the relations and interaction of entities
    (e.g. the *radiocarbon laboratory* is linked to the *sample* via the process of *measurement*).
    Some relationships have additional arguments (the *measurement* produces a *labnr*, happens at
    a certain *time* and has a specific *price* tag). Some relationships will become tables in the
    database, others won't. That depends on the nature of the relationship.</li>
  <li>Lines: Lines connect entities and relationships. Each line has a label to describe the amount
    of objects within an entity that can or have to be part of that relationship. Some examples:
    *(0,\*)*: Zero or many objects can be part of that that relationship. *(1,1)*: Exactly one object
    can be part of that relationship. That also implies that each object has to have exactly one
    partner in this specific relationship. *(0,1)*: Each object linked to the relationship has zero or
    one partner within the other linked entity. </li>
</ul>

<p>
The source file for this visualisation can be found here:
<a href="https://github.com/xronos-ch/xronos.rails/blob/master/xronos_structure/xronos_erd.dia">xronos_erd.dia</a>
(this file can be opened and edited with the diagram editor software <a href="http://dia-installer.de/">Dia</a>)
</p>
